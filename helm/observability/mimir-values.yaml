# Minimal mimir-distributed 5.x configuration (classic mode, no Kafka)

# Enable multi-tenancy
mimir:
  structuredConfig:
    multitenancy_enabled: true

    common:
      storage:
        backend: filesystem
        filesystem:
          dir: /data/mimir

    # Single replica replication settings
    ingester:
      ring:
        replication_factor: 1

    blocks_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/blocks
      tsdb:
        dir: /data/mimir/tsdb

    compactor:
      data_dir: /data/compactor

    limits:
      max_global_series_per_user: 500000
      ingestion_rate: 50000
      ingestion_burst_size: 100000

# Single replica for all components
distributor:
  replicas: 1
  resources:
    requests:
      cpu: 10m
      memory: 64Mi
    limits:
      cpu: 500m
      memory: 512Mi

ingester:
  replicas: 1
  zoneAwareReplication:
    enabled: false
  persistentVolume:
    enabled: true
    size: 10Gi
  resources:
    requests:
      cpu: 10m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 1Gi

querier:
  replicas: 1
  resources:
    requests:
      cpu: 10m
      memory: 64Mi
    limits:
      cpu: 500m
      memory: 512Mi

query_frontend:
  replicas: 1
  resources:
    requests:
      cpu: 10m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

store_gateway:
  replicas: 1
  zoneAwareReplication:
    enabled: false
  persistentVolume:
    enabled: true
    size: 5Gi
  resources:
    requests:
      cpu: 10m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 512Mi

# Disable compactor for simplicity (not needed for basic demo)
compactor:
  enabled: false

# Disable optional components
ruler:
  enabled: false

alertmanager:
  enabled: false

overrides_exporter:
  enabled: false

query_scheduler:
  enabled: false

# Use nginx as gateway
nginx:
  enabled: true
  replicas: 1

# Disable caches (use in-memory defaults)
chunks-cache:
  enabled: false
results-cache:
  enabled: false
metadata-cache:
  enabled: false

# No minio - using filesystem
minio:
  enabled: false

# Rollout operator not needed for single replica
rollout_operator:
  enabled: false
